<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Dr. AI – TeleMed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="canonical" href="/dr-ai" />
  <link rel="stylesheet" href="/css/theme-telemed.css" />
  <style>
    .hero{background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 40%,#22d3ee 100%);color:#fff;border-radius:20px;box-shadow:0 16px 40px rgba(2,6,23,.2);padding:32px 20px;margin:16px 0}
    .hero h1{margin:0 0 8px;font-size:2rem}
    .hero p{margin:0 0 16px;color:#eaf6ff}
    .hero .actions{display:flex;gap:10px;flex-wrap:wrap}
    .grid.cards.tight{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .step-num{display:inline-grid;place-items:center;width:28px;height:28px;border-radius:999px;background:#e6f6fe;color:#075985;font-weight:700;margin-right:8px}
    /* Demo Pacientes */
    .demo{background:#fff;border-radius:20px;box-shadow:0 16px 40px rgba(2,6,23,.08);padding:20px}
    .demo .form-row{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .risk{display:inline-block;border-radius:999px;padding:6px 10px;font-weight:700}
    .risk.baixo{background:#ecfdf5;color:#065f46}
    .risk.moderado{background:#fff7ed;color:#9a3412}
    .risk.alto{background:#fef2f2;color:#991b1b}
    .result .next{display:grid;gap:8px}
    .note{color:#6b7280;font-size:.9rem}
    .video{background:#0b1220;border-radius:16px;min-height:220px;display:grid;place-items:center;color:#b3c1d1}
    @media (min-width:1024px){ .hero h1{font-size:2.2rem} }
  </style>
</head>
<body>
  <div class="container">
    <a class="btn" href="/dashboard">← Voltar</a>

    <!-- HERO -->
    <section class="hero">
      <h1>Conheça o Dr. AI</h1>
      <p>Sua IA médica que entende sintomas, identifica riscos e sugere especialistas em segundos.</p>
      <div class="actions">
        <a class="btn btn-primary" href="#demo-pacientes">Demonstração para Pacientes</a>
        <a class="btn btn-outline" href="/consulta?demo=1">Versão para Médicos (na Consulta)</a>
      </div>
    </section>

    <!-- COMO FUNCIONA (resumo em 3 passos) -->
    <section class="section">
      <div class="prose center">
        <h2>Como o Dr. AI funciona</h2>
        <p class="muted">Triagem inteligente em 3 passos</p>
      </div>
      <div class="grid cards tight mt-3">
        <article class="card"><div class="card-body">
          <div><span class="step-num">1</span><strong>Descreva os sintomas</strong></div>
          <p class="mt-2">Conte em linguagem natural; o Dr. AI entende contexto, duração e intensidade.</p>
        </div></article>
        <article class="card"><div class="card-body">
          <div><span class="step-num">2</span><strong>Análise inteligente</strong></div>
          <p class="mt-2">A IA verifica sinais de alerta e cruza com diretrizes clínicas.</p>
        </div></article>
        <article class="card"><div class="card-body">
          <div><span class="step-num">3</span><strong>Próximos passos</strong></div>
          <p class="mt-2">Sugere especialidade e orienta a seguir para o agendamento.</p>
        </div></article>
      </div>
    </section>

    <!-- DEMONSTRAÇÃO PARA PACIENTES -->
    <section class="section" id="demo-pacientes" aria-labelledby="h-demo">
      <div class="prose center">
        <h2 id="h-demo">Demonstração para Pacientes</h2>
        <p class="muted">Simule uma triagem: preencha abaixo e veja o resultado</p>
      </div>

      <div class="demo mt-3">
        <form id="demoForm">
          <div class="form-row">
            <div class="field" style="grid-column:1/-1">
              <label for="sx">O que você está sentindo?</label>
              <textarea id="sx" rows="3" placeholder="Ex.: dor no peito, falta de ar, febre, manchas na pele..."></textarea>
            </div>

            <div class="field">
              <label for="dur">Há quanto tempo?</label>
              <select id="dur">
                <option value="0-24h">0–24h</option>
                <option value="2-7d">2–7 dias</option>
                <option value="8-14d">8–14 dias</option>
                <option value="15d+">15 dias ou mais</option>
              </select>
            </div>

            <div class="field">
              <label for="sev">Intensidade</label>
              <!-- sem oninput inline -->
              <input id="sev" type="range" min="0" max="10" value="5" />
              <div><small>Valor: <strong id="sevOut">5</strong>/10</small></div>
            </div>
          </div>

          <details class="mt-3">
            <summary><strong>Algum destes sinais de alerta?</strong></summary>
            <div class="form-row mt-2">
              <label><input type="checkbox" class="rf" value="dor-peito"> Dor forte no peito</label>
              <label><input type="checkbox" class="rf" value="falta-ar"> Falta de ar intensa</label>
              <label><input type="checkbox" class="rf" value="desmaio"> Desmaio/confusão</label>
              <label><input type="checkbox" class="rf" value="sangramento"> Sangramento importante</label>
              <label><input type="checkbox" class="rf" value="febre-alta"> Febre alta persistente</label>
              <label><input type="checkbox" class="rf" value="ideacao"> Ideação suicida</label>
              <label><input type="checkbox" class="rf" value="rigidez-nuca"> Rigidez na nuca</label>
            </div>
          </details>

          <div class="mt-3">
            <!-- type=button evita submit da página -->
            <button type="button" id="run" class="btn btn-primary">Analisar</button>
            <button type="button" id="clear" class="btn">Limpar</button>
          </div>
        </form>

        <div id="resultado" class="result mt-3" aria-live="polite"></div>
        <p class="note mt-3">
          <strong>Atenção:</strong> esta é uma demonstração educacional e <u>não substitui</u> atendimento médico.
          Em caso de emergência, procure um serviço de urgência.
        </p>
      </div>
    </section>

    <!-- PRÉVIA / VERSÃO MÉDICOS -->
    <section class="section">
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(320px,1fr));align-items:center">
        <div class="video">Prévia visual (opcional)</div>
        <div class="prose">
          <h3>Para médicos</h3>
          <p>Veja o Dr. AI dentro da <strong>Consulta Avançada</strong>, com integração ao prontuário e resumo clínico.</p>
          <a class="btn btn-primary" href="/consulta?demo=1">Abrir versão para Médicos</a>
        </div>
      </div>
    </section>

    <!-- CTA FINAL -->
    <section class="section center">
      <h3>Pronto para começar?</h3>
      <p class="muted">Leva menos de 2 minutos para a primeira avaliação.</p>
      <a class="btn btn-primary" href="/consulta">Iniciar Triagem</a>
      <a class="btn" href="/centro-de-testes">Centro de Testes</a>
    </section>
  </div>

  <script>
    // util: remover acentos e normalizar
    const norm = s => (s||'').toLowerCase()
      .normalize('NFD').replace(/[\u0300-\u036f]/g, '');

    // mapeamento simples de palavras-chave → especialidade
    const MAP = [
      { esp:'Cardiologia',  kw:['peito','palpitacao','taquicardia','falta de ar','pressao alta','dor no peito'] },
      { esp:'Dermatologia', kw:['pele','mancha','coceira','lesao','acne','dermatite','rash'] },
      { esp:'Psiquiatria',  kw:['ansiedade','panico','depressao','humor','insônia','ideacao','suicida'] },
      { esp:'Ortopedia',    kw:['lombar','queda','torcao','osso','coluna','entorse','fratura'] },
      { esp:'Gastro',       kw:['abdominal','nausea','vomito','diarreia','azia','refluxo'] },
      { esp:'Clínica Geral',kw:['gripe','febre','tosse','dor garganta','mal estar','cansaco'] }
    ];

    function sugerirEspecialidade(texto){
      const t = norm(texto);
      for (const row of MAP){
        if (row.kw.some(k => t.includes(k))) return row.esp;
      }
      return 'Clínica Geral';
    }

    function classificarRisco(sev, dur, redflags){
      if (redflags.length) return {nivel:'Alto', class:'alto', msg:'Sinal de alerta informado'};
      if (sev>=8) return {nivel:'Alto', class:'alto', msg:'Intensidade muito alta'};
      if (sev>=5 && (dur==='15d+' || dur==='8-14d')) return {nivel:'Moderado', class:'moderado', msg:'Sintomas persistentes'};
      return {nivel:'Baixo', class:'baixo', msg:'Sem sinais importantes detectados'};
    }

    function runDemo(){
      const sx   = document.getElementById('sx').value.trim();
      const dur  = document.getElementById('dur').value;
      const sev  = +document.getElementById('sev').value;
      const rfs  = [...document.querySelectorAll('.rf:checked')].map(c=>c.value);

      const esp  = sugerirEspecialidade(sx);
      const risco= classificarRisco(sev, dur, rfs);

      const nextSteps = [];
      if (risco.class==='alto'){
        nextSteps.push('Procure atendimento de urgência se os sintomas forem intensos ou súbitos.');
        nextSteps.push('Se estiver em segurança, siga para uma avaliação médica.');
      } else if (risco.class==='moderado'){
        nextSteps.push(`Agende uma consulta com ${esp} nas próximas 24–72h.`);
      } else {
        nextSteps.push(`Você pode iniciar por ${esp}.`);
      }
      nextSteps.push('Leve a descrição dos sintomas para agilizar sua consulta.');

      const qsEsp = encodeURIComponent(esp);
      const hrefConsulta = `/consulta?esp=${qsEsp}`;
      const hrefAgenda   = `/agenda?esp=${qsEsp}`;

      const html = `
        <div class="card">
          <div class="card-body">
            <h3>Resultado da Demonstração</h3>
            <p><strong>Especialidade sugerida:</strong> ${esp}</p>
            <p><strong>Classificação do risco:</strong> <span class="risk ${risco.class}">${risco.nivel}</span> <span class="muted">— ${risco.msg}</span></p>
            <div class="next mt-2">
              ${nextSteps.map(s=>`<div>• ${s}</div>`).join('')}
            </div>
            <div class="mt-3">
              <a class="btn btn-primary" href="${
