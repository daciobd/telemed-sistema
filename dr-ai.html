<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. AI - Assistente M√©dico Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        .chat-container {
            height: 500px;
            overflow-y: auto;
        }
        
        .message {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .ai-thinking {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .disclaimer-banner {
            background: linear-gradient(45deg, #fef3c7, #fde68a);
            border-left: 4px solid #f59e0b;
        }
        
        .critical-alert {
            background: linear-gradient(45deg, #fee2e2, #fecaca);
            border-left: 4px solid #ef4444;
            animation: alertPulse 2s infinite;
        }
        
        @keyframes alertPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .suggestion-card {
            transition: all 0.2s ease;
        }
        
        .suggestion-card:hover {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }
    </style>
</head>
<body>
    <div class="min-h-screen py-8 px-4">
        <div class="max-w-5xl mx-auto">
            <!-- Breadcrumb Navigation -->
            <nav class="bg-white/10 backdrop-blur-lg rounded-lg p-4 mb-6">
                <div class="flex items-center space-x-2 text-white text-sm">
                    <a href="/doctor-dashboard" class="hover:text-white/80">üìä Dashboard M√©dico</a>
                    <span>‚Üí</span>
                    <span class="font-semibold">ü§ñ Dr. AI - Assistente M√©dico</span>
                </div>
            </nav>

            <!-- Header -->
            <div class="text-center mb-8">
                <div class="inline-block bg-white/20 text-white text-sm font-bold px-4 py-2 rounded-full mb-4">
                    ü§ñ ASSISTENTE M√âDICO INTELIGENTE
                </div>
                <h1 class="text-4xl font-bold text-white mb-4">
                    Dr. AI - Copiloto Cl√≠nico
                </h1>
                <p class="text-xl text-white/90 max-w-3xl mx-auto">
                    Triagem inteligente e suporte √† decis√£o m√©dica
                </p>
                <p class="text-white/70 mt-2">
                    ‚ö†Ô∏è Ferramenta de apoio - N√£o substitui avalia√ß√£o m√©dica profissional
                </p>
            </div>

            <!-- Disclaimer Banner -->
            <div class="disclaimer-banner p-4 rounded-xl mb-6">
                <div class="flex items-start">
                    <div class="text-2xl mr-3">‚ö†Ô∏è</div>
                    <div>
                        <h3 class="font-bold text-amber-800 mb-1">Importante - Leia antes de continuar</h3>
                        <p class="text-amber-700 text-sm">
                            O Dr. AI √© um <strong>assistente automatizado</strong> que oferece triagem inicial e sugest√µes baseadas em protocolos cl√≠nicos. 
                            <strong>N√£o substitui consulta m√©dica</strong> e n√£o emite diagn√≥sticos ou prescri√ß√µes. 
                            Toda avalia√ß√£o definitiva deve ser realizada por profissional de sa√∫de.
                        </p>
                    </div>
                </div>
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Chat Interface -->
                <div class="lg:col-span-2 bg-white rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">üí¨ Triagem Inteligente</h2>
                        <div class="flex items-center text-sm text-gray-500">
                            <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                            Dr. AI Online
                        </div>
                    </div>
                    
                    <!-- Chat Container -->
                    <div class="chat-container bg-gray-50 rounded-xl p-4 mb-4" id="chatContainer">
                        <div class="message mb-4">
                            <div class="flex items-start">
                                <div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">
                                    ü§ñ
                                </div>
                                <div class="bg-blue-50 p-3 rounded-lg flex-1">
                                    <p class="text-gray-800">
                                        Ol√°! Sou o Dr. AI, seu assistente de triagem m√©dica. Vou fazer algumas perguntas para entender melhor seus sintomas e sugerir os pr√≥ximos passos.
                                    </p>
                                    <p class="text-xs text-gray-500 mt-2">
                                        ‚ö†Ô∏è Lembre-se: sou um assistente e n√£o substituo a consulta m√©dica.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Input Area -->
                    <div class="flex gap-3">
                        <input type="text" id="messageInput" placeholder="Descreva seus sintomas ou como est√° se sentindo..." 
                               class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors">
                            Enviar
                        </button>
                    </div>

                    <!-- Quick Suggestions -->
                    <div class="mt-4">
                        <p class="text-sm text-gray-600 mb-2">üí° Sugest√µes r√°pidas:</p>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="quickSuggestion('Estou com febre e dor de cabe√ßa')" 
                                    class="suggestion-card text-xs bg-gray-100 hover:bg-blue-50 px-3 py-1 rounded-full border transition-colors">
                                Febre e dor de cabe√ßa
                            </button>
                            <button onclick="quickSuggestion('Dor abdominal h√° algumas horas')" 
                                    class="suggestion-card text-xs bg-gray-100 hover:bg-blue-50 px-3 py-1 rounded-full border transition-colors">
                                Dor abdominal
                            </button>
                            <button onclick="quickSuggestion('Tosse seca persistente')" 
                                    class="suggestion-card text-xs bg-gray-100 hover:bg-blue-50 px-3 py-1 rounded-full border transition-colors">
                                Tosse persistente
                            </button>
                            <button onclick="quickSuggestion('Ansiedade e palpita√ß√µes')" 
                                    class="suggestion-card text-xs bg-gray-100 hover:bg-blue-50 px-3 py-1 rounded-full border transition-colors">
                                Ansiedade
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Panel -->
                <div class="space-y-6">
                    <!-- Clinical Support -->
                    <div class="bg-white rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">ü©∫ Suporte Cl√≠nico</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-green-50 rounded-lg">
                                <div class="font-medium text-green-800 text-sm">Para M√©dicos</div>
                                <div class="text-green-700 text-xs">Visualize o racioc√≠nio da IA e personalize protocolos</div>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <div class="font-medium text-blue-800 text-sm">Relat√≥rios Pr√©-Consulta</div>
                                <div class="text-blue-700 text-xs">Economize tempo com sum√°rios estruturados</div>
                            </div>
                            <div class="p-3 bg-purple-50 rounded-lg">
                                <div class="font-medium text-purple-800 text-sm">Protocolos Validados</div>
                                <div class="text-purple-700 text-xs">Baseado em diretrizes m√©dicas atualizadas</div>
                            </div>
                        </div>
                    </div>

                    <!-- Safety Features -->
                    <div class="bg-white rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">üõ°Ô∏è Seguran√ßa</h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                                <span class="text-gray-700">Conformidade LGPD</span>
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                                <span class="text-gray-700">Resolu√ß√£o CFM 2.227/2018</span>
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                                <span class="text-gray-700">Logs audit√°veis</span>
                            </div>
                            <div class="flex items-center">
                                <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                                <span class="text-gray-700">Redirecionamento autom√°tico</span>
                            </div>
                        </div>
                    </div>

                    <!-- Emergency Protocol -->
                    <div class="bg-red-50 border-2 border-red-200 rounded-2xl p-6">
                        <h3 class="text-xl font-bold text-red-800 mb-4">üö® Emerg√™ncia</h3>
                        <p class="text-red-700 text-sm mb-4">
                            Em caso de emerg√™ncia m√©dica, procure imediatamente:
                        </p>
                        <div class="space-y-2 text-sm">
                            <div class="text-red-700">üìû SAMU: 192</div>
                            <div class="text-red-700">üè• UPA mais pr√≥xima</div>
                            <div class="text-red-700">üöë Pronto Socorro</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="text-center mt-8">
                <button onclick="goToCenter()" class="bg-white/20 hover:bg-white/30 text-white px-8 py-3 rounded-lg transition-colors mr-4">
                    üß† Centro de Avalia√ß√£o
                </button>
                <button onclick="goToDashboard()" class="bg-white/20 hover:bg-white/30 text-white px-8 py-3 rounded-lg transition-colors">
                    üìä Dashboard Principal
                </button>
            </div>
        </div>
    </div>

    <script>
        console.log('ü§ñ Dr. AI 2.0 - Copiloto M√©dico carregado');

        let conversationHistory = [];
        
        // Clinical protocols and responses
        const clinicalProtocols = {
            fever: {
                questions: [
                    "H√° quanto tempo voc√™ est√° com febre?",
                    "Qual a temperatura m√°xima registrada?",
                    "Tem outros sintomas como dor de garganta, tosse ou dor no corpo?",
                    "Teve contato com pessoas doentes recentemente?"
                ],
                suggestions: [
                    "Verificar sinais vitais completos",
                    "Investigar foco infeccioso",
                    "Considerar s√≠ndrome gripal",
                    "Avaliar necessidade de exames complementares"
                ],
                urgency: "medium"
            },
            abdominal: {
                questions: [
                    "Onde exatamente √© a dor abdominal?",
                    "A dor √© constante ou vem em ondas?",
                    "H√° n√°usea, v√¥mito ou altera√ß√£o do intestino?",
                    "J√° teve essa dor antes?"
                ],
                suggestions: [
                    "Examinar abdome por quadrantes",
                    "Verificar sinais de peritonite",
                    "Considerar abdome agudo",
                    "Avaliar sinais de alerta"
                ],
                urgency: "high"
            },
            respiratory: {
                questions: [
                    "A tosse √© seca ou com secre√ß√£o?",
                    "H√° falta de ar ou chiado no peito?",
                    "Quando os sintomas come√ßaram?",
                    "Tem febre associada?"
                ],
                suggestions: [
                    "Ausculta pulmonar detalhada",
                    "Verificar satura√ß√£o de oxig√™nio",
                    "Investigar pneumonia",
                    "Avaliar fun√ß√£o respirat√≥ria"
                ],
                urgency: "medium"
            },
            anxiety: {
                questions: [
                    "Como voc√™ descreveria os sentimentos de ansiedade?",
                    "H√° palpita√ß√µes ou sensa√ß√£o de falta de ar?",
                    "Que situa√ß√µes parecem desencadear a ansiedade?",
                    "J√° teve epis√≥dios similares antes?"
                ],
                suggestions: [
                    "Avaliar sinais vitais em repouso",
                    "Investigar transtornos de ansiedade",
                    "Considerar suporte psicol√≥gico",
                    "Avaliar necessidade de medica√ß√£o"
                ],
                urgency: "low"
            }
        };

        // Emergency keywords that trigger immediate alerts
        const emergencyKeywords = [
            "dor no peito", "infarto", "avc", "derrame", "desmaio", "sangramento", 
            "dificuldade respirar", "n√£o consigo respirar", "emerg√™ncia", "socorro",
            "overdose", "suic√≠dio", "tentativa"
        ];

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addMessage(message, 'user');
            input.value = '';
            
            // Check for emergency keywords
            if (checkEmergency(message)) {
                showEmergencyAlert();
                return;
            }
            
            // Show AI thinking
            showAIThinking();
            
            // Process message after delay (simulate AI processing)
            setTimeout(() => {
                processMessage(message);
            }, 2000);
        }

        function quickSuggestion(suggestion) {
            document.getElementById('messageInput').value = suggestion;
            sendMessage();
        }

        function addMessage(text, sender) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message mb-4';
            
            const isUser = sender === 'user';
            const avatarBg = isUser ? 'bg-gray-500' : 'bg-blue-500';
            const messageBg = isUser ? 'bg-gray-100' : 'bg-blue-50';
            const avatar = isUser ? 'üë§' : 'ü§ñ';
            
            messageDiv.innerHTML = `
                <div class="flex items-start ${isUser ? 'flex-row-reverse' : ''}">
                    <div class="${avatarBg} text-white rounded-full w-8 h-8 flex items-center justify-center ${isUser ? 'ml-3' : 'mr-3'} text-sm">
                        ${avatar}
                    </div>
                    <div class="${messageBg} p-3 rounded-lg flex-1">
                        <p class="text-gray-800">${text}</p>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            conversationHistory.push({ sender, text, timestamp: new Date() });
        }

        function showAIThinking() {
            const chatContainer = document.getElementById('chatContainer');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'message mb-4 ai-thinking';
            thinkingDiv.id = 'thinking';
            
            thinkingDiv.innerHTML = `
                <div class="flex items-start">
                    <div class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">
                        ü§ñ
                    </div>
                    <div class="bg-blue-50 p-3 rounded-lg flex-1">
                        <p class="text-gray-600">Dr. AI est√° analisando seus sintomas...</p>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(thinkingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function processMessage(message) {
            // Remove thinking indicator
            const thinking = document.getElementById('thinking');
            if (thinking) thinking.remove();
            
            // Determine protocol based on message content
            let protocol = determineProtocol(message);
            let response = generateResponse(message, protocol);
            
            addMessage(response, 'ai');
        }

        function determineProtocol(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('febre') || lowerMessage.includes('temperatura')) {
                return 'fever';
            }
            if (lowerMessage.includes('dor abdominal') || lowerMessage.includes('barriga')) {
                return 'abdominal';
            }
            if (lowerMessage.includes('tosse') || lowerMessage.includes('peito') || lowerMessage.includes('respirar')) {
                return 'respiratory';
            }
            if (lowerMessage.includes('ansiedade') || lowerMessage.includes('nervoso') || lowerMessage.includes('palpita√ß√£o')) {
                return 'anxiety';
            }
            
            return 'general';
        }

        function generateResponse(message, protocolType) {
            if (protocolType === 'general') {
                return `Obrigado por compartilhar seus sintomas. Para fazer uma avalia√ß√£o mais precisa, preciso de algumas informa√ß√µes:

1. H√° quanto tempo voc√™ sente esses sintomas?
2. Os sintomas est√£o piorando, melhorando ou est√°veis?
3. Voc√™ tem alguma condi√ß√£o m√©dica conhecida?
4. Est√° tomando algum medicamento?

Com base nessas informa√ß√µes, posso sugerir os pr√≥ximos passos apropriados. Lembre-se: recomendo consulta m√©dica para avalia√ß√£o completa.`;
            }
            
            const protocol = clinicalProtocols[protocolType];
            const question = protocol.questions[Math.floor(Math.random() * protocol.questions.length)];
            const suggestion = protocol.suggestions[Math.floor(Math.random() * protocol.suggestions.length)];
            
            let urgencyMessage = "";
            if (protocol.urgency === "high") {
                urgencyMessage = "\n\n‚ö†Ô∏è **ATEN√á√ÉO**: Seus sintomas podem indicar uma condi√ß√£o que requer avalia√ß√£o m√©dica urgente. Recomendo procurar atendimento m√©dico imediatamente.";
            } else if (protocol.urgency === "medium") {
                urgencyMessage = "\n\nüí° **Recomenda√ß√£o**: Sugiro agendar consulta m√©dica nas pr√≥ximas 24-48 horas para avalia√ß√£o adequada.";
            }
            
            return `Entendi seus sintomas. ${question}

**Sugest√£o cl√≠nica para o m√©dico**: ${suggestion}${urgencyMessage}

Posso fazer mais perguntas para ajudar na triagem. Continue descrevendo seus sintomas.`;
        }

        function checkEmergency(message) {
            const lowerMessage = message.toLowerCase();
            return emergencyKeywords.some(keyword => lowerMessage.includes(keyword));
        }

        function showEmergencyAlert() {
            const chatContainer = document.getElementById('chatContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = 'message mb-4';
            
            alertDiv.innerHTML = `
                <div class="flex items-start">
                    <div class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm">
                        üö®
                    </div>
                    <div class="critical-alert p-4 rounded-lg flex-1">
                        <div class="font-bold text-red-800 mb-2">üö® ALERTA DE EMERG√äNCIA DETECTADO</div>
                        <p class="text-red-700 mb-3">
                            Baseado nos seus sintomas, recomendo procurar atendimento m√©dico de emerg√™ncia IMEDIATAMENTE.
                        </p>
                        <div class="text-red-800 font-medium">
                            üìû SAMU: 192<br>
                            üè• Dirija-se √† UPA ou Pronto Socorro mais pr√≥ximo<br>
                            üöë Em caso de impossibilidade de locomo√ß√£o, chame ambul√¢ncia
                        </div>
                        <p class="text-xs text-red-600 mt-3">
                            N√£o aguarde. Emerg√™ncias m√©dicas requerem atendimento imediato.
                        </p>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(alertDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function goToCenter() {
            window.location.href = '/centro-avaliacao';
        }

        function goToDashboard() {
            window.location.href = '/doctor-dashboard';
        }

        // Handle Enter key press
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Initialize system
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Dr. AI sistema inicializado');
            console.log('ü©∫ Protocolos cl√≠nicos carregados');
            console.log('üõ°Ô∏è Sistema de seguran√ßa ativo');
        });
    </script>
</body>
</html>